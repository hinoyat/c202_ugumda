<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>SSE μ•λ¦Ό ν…μ¤νΈ</title>
</head>
<body>
<h2>π”” μ‹¤μ‹κ°„ μ•λ¦Ό μμ‹  ν…μ¤νΈ</h2>
<div id="log" style="white-space: pre-wrap;"></div>

<script>
    const userSeq = 123; // μ›ν•λ” μ μ € λ²νΈλ΅ λ³€κ²½!
    const eventSource = new EventSource(`http://localhost:8086/notifications/subscribe/${userSeq}`);

    const logBox = document.getElementById("log");

    eventSource.addEventListener("connect", (e) => {
        logBox.innerText += `μ—°κ²°λ¨: ${e.data}\n`;
    });

    eventSource.addEventListener("alarm", (e) => {
        const alarm = JSON.parse(e.data);
        logBox.innerText += `μ•λ¦Ό λ„μ°©!\nλ‚΄μ©: ${alarm.content}\nμ ν•: ${alarm.type}\n\n`;
    });

    eventSource.onerror = (e) => {
        logBox.innerText += `μ¤λ¥ λ°μƒ!\n`;
        console.error(e);
    };
</script>
</body>
</html>
